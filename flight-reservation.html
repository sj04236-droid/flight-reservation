<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>í•­ê³µê¶Œ ì˜ˆì•½</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
  <div class="max-w-2xl mx-auto bg-white p-6 mt-8 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-6">í•­ê³µê¶Œ ì˜ˆì•½ ì‹ ì²­</h1>

    <!-- íƒ­ ì„ íƒ -->
    <div class="flex mb-4 space-x-2">
      <button class="tab-btn selected" onclick="selectTab('round')">ì™•ë³µ</button>
      <button class="tab-btn" onclick="selectTab('oneway')">í¸ë„</button>
      <button class="tab-btn" onclick="selectTab('multi')">ë‹¤êµ¬ê°„</button>
    </div>

    <form id="reservationForm">
      <input id="tabValue" name="tab" type="hidden" value="ì™•ë³µ" />

      <!-- ì™•ë³µ -->
      <div id="round" class="tab-panel">
        <div class="mb-4"><label class="block font-semibold">ì¶œë°œì§€</label><input class="input-box" list="airportList" name="departure" required></div>
        <div class="mb-4"><label class="block font-semibold">ë„ì°©ì§€</label><input class="input-box" list="airportList" name="arrival" required></div>
        <div class="mb-4"><label class="block font-semibold">ì¶œë°œì¼</label><input class="input-box" type="date" name="departureDate" required></div>
        <div class="mb-4"><label class="block font-semibold">ë¦¬í„´ì¼</label><input class="input-box" type="date" name="returnDate"></div>
      </div>

      <!-- í¸ë„ -->
      <div id="oneway" class="tab-panel hidden">
        <div class="mb-4"><label class="block font-semibold">ì¶œë°œì§€</label><input class="input-box" list="airportList" name="onewayDeparture" required></div>
        <div class="mb-4"><label class="block font-semibold">ë„ì°©ì§€</label><input class="input-box" list="airportList" name="onewayArrival" required></div>
        <div class="mb-4"><label class="block font-semibold">ì¶œë°œì¼</label><input class="input-box" type="date" name="onewayDate" required></div>
      </div>

      <!-- ë‹¤êµ¬ê°„ -->
      <div id="multi" class="tab-panel hidden">
        <div id="multiSegments"></div>
        <button type="button" onclick="addSegment()" class="text-blue-600 underline mt-2">+ ë‹¤ë¥¸ êµ¬ê°„ ì¶”ê°€</button>
      </div>

      <!-- ìš”ì²­ì‚¬í•­ -->
      <div class="mb-4 mt-6"><label class="block font-semibold">ìš”ì²­ì‚¬í•­</label><textarea class="input-box" name="request" rows="4"></textarea></div>
      <div class="text-sm text-gray-600 bg-gray-100 p-3 rounded mb-4">
        <p>âœ… ìš”ì²­ì‚¬í•­ ì˜ˆì‹œ</p>
        <ul class="list-disc pl-5">
          <li>â‘  íƒ‘ìŠ¹ì ì˜ë¬¸ì´ë¦„/ì„±ë³„ (ì•„ë™ì€ ìƒë…„ì›”ì¼)</li>
          <li>â‘¡ í¬ë§ í•­ê³µì‚¬ / í¬ë§ ìŠ¤ì¼€ì¤„ ì‹œê°„ëŒ€</li>
          <li>â‘¢ ê¸°íƒ€ ìš”ì²­ì‚¬í•­</li>
        </ul>
      </div>

      <!-- ì˜ˆì•½ì ì •ë³´ -->
      <div class="mb-4"><label class="block font-semibold">ì˜ˆì•½ì ì´ë¦„</label><input class="input-box" name="name" required></div>
      <div class="mb-4"><label class="block font-semibold">ì „í™”ë²ˆí˜¸</label><input class="input-box" name="phone" required></div>
      <div class="mb-4"><label class="block font-semibold">ì´ë©”ì¼</label><input class="input-box" name="email" type="email"></div>

      <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">ì˜ˆì•½ ìš”ì²­í•˜ê¸°</button>

      <div id="completeMessage" class="hidden mt-4 text-center">
        <p class="text-green-600 font-semibold">âœ… ì˜ˆì•½ ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</p>
        <a href="https://open.kakao.com/o/somechatlink" target="_blank" class="text-blue-600 underline mt-2 inline-block">ğŸ‘‰ ìƒë‹´ ì—°ê²°</a>
      </div>
    </form>
  </div>

  <datalist id="airportList">
    <option value="ICN ì¸ì²œ"></option>
    <option value="GMP ê¹€í¬"></option>
    <option value="CJU ì œì£¼"></option>
    <option value="NRT ë„ì¿„"></option>
    <option value="KIX ì˜¤ì‚¬ì¹´"></option>
    <option value="LHR ëŸ°ë˜"></option>
    <option value="CDG íŒŒë¦¬"></option>
    <option value="JFK ë‰´ìš•"></option>
    <option value="LAX LA"></option>
    <option value="SFO ìƒŒí”„ë€ì‹œìŠ¤ì½”"></option>
  </datalist>

  <style>
    .input-box { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 0.375rem; }
    .tab-btn { padding: 0.5rem 1rem; border: 1px solid #ccc; border-radius: 0.375rem; background: #fff; }
    .tab-btn.selected { background: #2563eb; color: white; }
    .tab-panel { margin-top: 1rem; }
  </style>

  <script>
    const tabMap = {
      round: "ì™•ë³µ",
      oneway: "í¸ë„",
      multi: "ë‹¤êµ¬ê°„"
    };

    function selectTab(tabName) {
      document.getElementById("tabValue").value = tabMap[tabName];
      document.querySelectorAll(".tab-panel").forEach(el => el.classList.add("hidden"));
      document.querySelectorAll(".tab-btn").forEach(el => el.classList.remove("selected"));
      document.getElementById(tabName).classList.remove("hidden");
      event.target.classList.add("selected");
    }

    let segmentCount = 1;
    function addSegment() {
      if (segmentCount >= 6) return;
      segmentCount++;
      const container = document.getElementById("multiSegments");
      const html = `
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-2">
          <input list="airportList" name="multi_from_${segmentCount}" placeholder="ì¶œë°œì§€" class="input-box" required>
          <input list="airportList" name="multi_to_${segmentCount}" placeholder="ë„ì°©ì§€" class="input-box" required>
          <input type="date" name="multi_date_${segmentCount}" class="input-box" required>
        </div>`;
      container.insertAdjacentHTML("beforeend", html);
    }

    window.onload = () => {
      addSegment(); // ë‹¤êµ¬ê°„ 1ê°œ ê¸°ë³¸
    };

    document.getElementById("reservationForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((v, k) => data[k] = v);

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbyabqq9tBQqWLqwouShBrqgnunMrhPyi44lcqAKOdfNhfj129vvqg9aUT8SjwN8UF-F/exec", {
          method: "POST",
          body: new URLSearchParams(data)
        });

        if (response.ok) {
          document.getElementById("completeMessage").classList.remove("hidden");
          e.target.reset();
        } else {
          alert("ì˜ˆì•½ ìš”ì²­ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      } catch (error) {
        alert("ì˜¤ë¥˜ ë°œìƒ: " + error);
      }
    });
  </script>
</body>
</html>
