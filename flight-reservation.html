<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>항공권 예약 신청</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .input-box { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 0.375rem; }
    .tab-btn { padding: 0.5rem 1rem; border: 1px solid #ddd; border-radius: 0.375rem; background: #fff; }
    .tab-btn.selected { background: #2563eb; color: #fff; }
    .tab-panel { margin-top: 1rem; }
  </style>
</head>
<body class="bg-gray-50 p-6">
  <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-6">항공권 예약 신청</h1>

    <!-- 탭 선택 -->
    <div class="flex mb-4 space-x-2">
      <button type="button" class="tab-btn selected" onclick="selectTab('round')">왕복</button>
      <button type="button" class="tab-btn" onclick="selectTab('oneway')">편도</button>
      <button type="button" class="tab-btn" onclick="selectTab('multi')">다구간</button>
    </div>

    <!-- ⭐ form에 action 직접 설정 -->
    <form action="https://script.google.com/macros/s/AKfycbyabqq9tBQqWLqwouShBrqgnunMrhPyi44lcqAKOdfNhfj129vvqg9aUT8SjwN8UF-F/exec" method="post" target="dummyFrame" id="reservationForm">

      <input type="hidden" id="tabValue" name="tab" value="왕복">

      <!-- 왕복 -->
      <div id="round" class="tab-panel">
        <div class="mb-4"><label class="block font-semibold">출발지</label><input class="input-box" list="airportList" name="departure" required></div>
        <div class="mb-4"><label class="block font-semibold">도착지</label><input class="input-box" list="airportList" name="arrival" required></div>
        <div class="mb-4"><label class="block font-semibold">출발일</label><input class="input-box" name="departureDate" type="date" required></div>
        <div class="mb-4"><label class="block font-semibold">리턴일</label><input class="input-box" name="returnDate" type="date"></div>
      </div>

      <!-- 편도 -->
      <div id="oneway" class="tab-panel hidden">
        <div class="mb-4"><label class="block font-semibold">출발지</label><input class="input-box" list="airportList" name="onewayDeparture"></div>
        <div class="mb-4"><label class="block font-semibold">도착지</label><input class="input-box" list="airportList" name="onewayArrival"></div>
        <div class="mb-4"><label class="block font-semibold">출발일</label><input class="input-box" name="onewayDate" type="date"></div>
      </div>

      <!-- 다구간 -->
      <div id="multi" class="tab-panel hidden">
        <div id="multiSegments"></div>
        <button type="button" class="text-blue-600 underline mt-2" onclick="addSegment()">+ 다른 구간 추가</button>
      </div>

      <!-- 요청사항 -->
      <div class="mb-4 mt-6">
        <label class="block font-semibold">요청사항</label>
        <textarea class="input-box" name="request" rows="4" placeholder="예: 탑승자 성명/성별/항공사/시간대 등"></textarea>
      </div>
      <div class="text-sm text-gray-500 mb-4 bg-gray-100 p-3 rounded">
        ✅ 요청사항 예시
        <ul class="list-disc pl-5">
          <li>① 탑승자 영문이름/성별 (아동은 생년월일)</li>
          <li>② 희망 항공사 / 희망 스케줄 시간대</li>
          <li>③ 기타 요청사항</li>
        </ul>
      </div>

      <!-- 예약자 인적사항 -->
      <div class="mb-4"><label class="block font-semibold">예약자 이름</label><input class="input-box" name="name" required placeholder="홍길동"></div>
      <div class="mb-4"><label class="block font-semibold">전화번호</label><input class="input-box" name="phone" required placeholder="010-1234-5678"></div>
      <div class="mb-4"><label class="block font-semibold">이메일</label><input class="input-box" name="email" placeholder="email@example.com"></div>

      <button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700" type="submit">예약 요청하기</button>

      <div id="completeMessage" class="hidden mt-4 text-green-600 text-center font-bold">
        ✅ 예약 요청이 완료되었습니다!
      </div>
    </form>

    <!-- 백그라운드용 더미 iframe (CORS 피하기용) -->
    <iframe name="dummyFrame" style="display:none;" onload="document.getElementById('completeMessage').classList.remove('hidden')"></iframe>
  </div>

  <!-- 공항 자동완성 -->
  <datalist id="airportList">
    <option value="ICN 인천"></option>
    <option value="GMP 김포"></option>
    <option value="CJU 제주"></option>
    <option value="NRT 도쿄"></option>
    <option value="KIX 오사카"></option>
    <option value="LHR 런던"></option>
    <option value="CDG 파리"></option>
    <option value="JFK 뉴욕"></option>
    <option value="LAX LA"></option>
    <option value="SFO 샌프란시스코"></option>
  </datalist>

  <script>
    const tabMap = { round: "왕복", oneway: "편도", multi: "다구간" };
    let segmentCount = 1;

    function selectTab(tabName) {
      document.getElementById("tabValue").value = tabMap[tabName];
      document.querySelectorAll(".tab-panel").forEach(el => el.classList.add("hidden"));
      document.querySelectorAll(".tab-btn").forEach(el => el.classList.remove("selected"));
      document.getElementById(tabName).classList.remove("hidden");
      event.target.classList.add("selected");
    }

    function addSegment() {
      if (segmentCount >= 6) return;
      segmentCount++;
      const container = document.getElementById("multiSegments");
      const html = `
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-2">
          <input list="airportList" name="multi_from_${segmentCount}" placeholder="출발지" class="input-box">
          <input list="airportList" name="multi_to_${segmentCount}" placeholder="도착지" class="input-box">
          <input type="date" name="multi_date_${segmentCount}" class="input-box">
        </div>`;
      container.insertAdjacentHTML("beforeend", html);
    }

    // 기본 다구간 1개 추가
    window.onload = () => addSegment();
  </script>
</body>
</html>
